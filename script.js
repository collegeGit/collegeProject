let currentTask=null;let selected=null;let hintsLeft=3;let progress={};let levelsCount=3;const tasks={'–ü–∞—Ä–æ–ª—ñ':[{q:"–Ø–∫–∏–π –ø–∞—Ä–æ–ª—å –Ω–∞–π–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π?",type:"single",o:["123456","password","Tr0ub4dor&3","admin"],c:2,hint:"–ú—ñ—Å—Ç–∏—Ç—å —Ü–∏—Ñ—Ä–∏, —Å–∏–º–≤–æ–ª–∏, –≤–µ–ª–∏–∫—ñ+–º–∞–ª—ñ –ª—ñ—Ç–µ—Ä–∏"},{q:"–í–∏–±–µ—Ä—ñ—Ç—å –í–°–Ü –æ–∑–Ω–∞–∫–∏ —Å–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è",type:"multi",o:["8+ —Å–∏–º–≤–æ–ª—ñ–≤","–¢—ñ–ª—å–∫–∏ —Ü–∏—Ñ—Ä–∏","–í–µ–ª–∏–∫—ñ+–º–∞–ª—ñ –ª—ñ—Ç–µ—Ä–∏","–°–∏–º–≤–æ–ª–∏ !@#"],c:[0,2,3],hint:"–í—Å–µ –∫—Ä—ñ–º '—Ç—ñ–ª—å–∫–∏ —Ü–∏—Ñ—Ä–∏'"},{q:"–Ø–∫–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –ø–∞—Ä–æ–ª—è?",type:"input",answer:"12",hint:"–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ 12+ —Å–∏–º–≤–æ–ª—ñ–≤"},{q:"–ß–∏ –º–æ–∂–Ω–∞ 'password'?",type:"single",o:["–¢–∞–∫","–ù—ñ, –Ω–∞–π—Å–ª–∞–±—à–∏–π!"],c:1,hint:"‚Ññ1 —É —Å–ø–∏—Å–∫—É –∑–ª–æ–º—É"},{q:"–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ:",type:"multi",o:["–£–Ω—ñ–∫–∞–ª—å–Ω–∏–π","–í –±—Ä–∞—É–∑–µ—Ä—ñ","–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª—ñ–≤","–ú—ñ–Ω—è—Ç–∏ —â–æ–º—ñ—Å—è—Ü—è?"],c:[0,2],hint:"–ë—Ä–∞—É–∑–µ—Ä –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π"},{q:"–©–æ —Ç–∞–∫–µ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª—ñ–≤?",type:"single",o:["–ü—Ä–æ–≥—Ä–∞–º–∞ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤","–ê–Ω—Ç–∏–≤—ñ—Ä—É—Å","–ë—Ä–∞—É–∑–µ—Ä"],c:0,hint:"–ó–±–µ—Ä—ñ–≥–∞—î —ñ –≥–µ–Ω–µ—Ä—É—î –ø–∞—Ä–æ–ª—ñ"},{q:"–Ø–∫—ñ –¥—ñ—ó –ø—ñ–¥–≤–∏—â—É—é—Ç—å –±–µ–∑–ø–µ–∫—É –ø–∞—Ä–æ–ª—è?",type:"multi",o:["–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –ø–∞—Ä–æ–ª—ñ","–ü–∏—Å–∞—Ç–∏ –Ω–∞ –ø–∞–ø–µ—Ä—ñ","–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–≤–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é","–î—ñ–ª–∏—Ç–∏—Å—è –∑ –¥—Ä—É–∑—è–º–∏"],c:[0,2],hint:"–¢—ñ–ª—å–∫–∏ –±–µ–∑–ø–µ—á–Ω—ñ –¥—ñ—ó"}],'–°–æ—Ü–º–µ—Ä–µ–∂—ñ':[{q:"–©–æ –ù–ï –ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏?",type:"multi",o:["–§–æ—Ç–æ —ó–∂—ñ","–ê–¥—Ä–µ—Å–∞ –¥–æ–º—É","–¢–µ–ª–µ—Ñ–æ–Ω","–í—ñ–¥–ø—É—Å—Ç–∫–∞ –∑–∞—Ä–∞–∑"],c:[1,2,3],hint:"–û—Å–æ–±–∏—Å—Ç—ñ –¥–∞–Ω—ñ = –Ω–µ–±–µ–∑–ø–µ–∫–∞"},{q:"–ó–∞–ø–∏—Ç–∏ –≤—ñ–¥ –Ω–µ–∑–Ω–∞–π–æ–º—Ü—ñ–≤?",type:"single",o:["–ü—Ä–∏–π–º–∞—Ç–∏","–í—ñ–¥–º–æ–≤–∏—Ç–∏"],c:1,hint:"99% - —à–∞—Ö—Ä–∞—ó"},{q:"–©–æ —Ä–æ–±–∏—Ç–∏ –ø—Ä–∏ –ø—ñ–¥–æ–∑—Ä—ñ–ª–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è—Ö?",type:"single",o:["–Ü–≥–Ω–æ—Ä—É–≤–∞—Ç–∏/–í–∏–¥–∞–ª—è—Ç–∏","–í—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏","–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –∑ –¥—Ä—É–∑—è–º–∏"],c:0,hint:"–ù–µ –≤–∑–∞—î–º–æ–¥—ñ–π—Ç–µ"},{q:"–Ø–∫—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—ñ –≤–∞–∂–ª–∏–≤—ñ?",type:"multi",o:["–ó–∞–∫—Ä–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å","–î—ñ–ª–∏—Ç–∏—Å—è –≤—Å—ñ–º","–û–±–º–µ–∂–∏—Ç–∏ –¥—Ä—É–∑—ñ","–ü—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –ø–æ—Å—Ç–∏ —Ç—ñ–ª—å–∫–∏ –¥–ª—è –¥—Ä—É–∑—ñ–≤"],c:[0,2,3],hint:"–í—Å–µ, —â–æ –æ–±–º–µ–∂—É—î –¥–æ—Å—Ç—É–ø"}],'–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞':[{q:"–õ–∏—Å—Ç '–ë–∞–Ω–∫ - –≤–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å'?",type:"single",o:["–í–≤–µ—Å—Ç–∏","–í–∏–¥–∞–ª–∏—Ç–∏","–í—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏"],c:1,hint:"–ë–∞–Ω–∫–∏ –ù–ï –ø—Ä–æ—Å—è—Ç—å –ø–∞—Ä–æ–ª—å"},{q:"–ü—ñ–¥–æ–∑—Ä—ñ–ª–µ –≤–∫–ª–∞–¥–µ–Ω–Ω—è?",type:"single",o:["–í—ñ–¥–∫—Ä–∏—Ç–∏","–í–∏–¥–∞–ª–∏—Ç–∏"],c:1,hint:"–í—ñ—Ä—É—Å 100%"},{q:"–§—ñ—à–∏–Ω–≥–æ–≤–∏–π –ª–∏—Å—Ç –º–æ–∂–Ω–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ –ø–æ:",type:"multi",o:["–ù–µ–≤—ñ–¥–æ–º–∏–π –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫","–ü–æ–º–∏–ª–∫–∏ –≤ —Ç–µ–∫—Å—Ç—ñ","–ó–∞–ø–∏—Ç –ø–∞—Ä–æ–ª—è","–í–∫–ª–∞–¥–µ–Ω–Ω—è –±–µ–∑ –ø—Ä–∏—á–∏–Ω–∏"],c:[0,2,3],hint:"–ó–≤–µ—Ä—Ç–∞–π—Ç–µ —É–≤–∞–≥—É –Ω–∞ –ø—ñ–¥–æ–∑—Ä—ñ–ª—ñ –¥–µ—Ç–∞–ª—ñ"}],'–§—ñ—à–∏–Ω–≥':[{q:"–û–∑–Ω–∞–∫–∏ —Ñ—ñ—à–∏–Ω–≥—É:",type:"multi",o:["–ù–µ–≤—ñ–¥–æ–º–∏–π","–¢–µ—Ä–º—ñ–Ω–æ–≤–æ!","–ü—ñ–¥–æ–∑—Ä—ñ–ª–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è","–Ü–¥–µ–∞–ª—å–Ω–∞ –≥—Ä–∞–º–∞—Ç–∏–∫–∞?"],c:[0,1,2],hint:"–í—Å–µ –∫—Ä—ñ–º –≥—Ä–∞–º–∞—Ç–∏–∫–∏"},{q:"–©–æ —Ä–æ–±–∏—Ç–∏ –ø—Ä–∏ —Ñ—ñ—à–∏–Ω–≥–æ–≤–æ–º—É –ø–æ—Å–∏–ª–∞–Ω–Ω—é?",type:"single",o:["–í—ñ–¥–∫—Ä–∏—Ç–∏","–Ü–≥–Ω–æ—Ä—É–≤–∞—Ç–∏/–í–∏–¥–∞–ª–∏—Ç–∏"],c:1,hint:"–ù–µ –∫–ª—ñ–∫–∞–π—Ç–µ –Ω–∞ –ø—ñ–¥–æ–∑—Ä—ñ–ª—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è"},{q:"–Ø–∫ –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ —Ñ—ñ—à–∏–Ω–≥—É?",type:"multi",o:["–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å","–ö–ª—ñ–∫–∞—Ç–∏ –ø–æ –≤—Å—ñ–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º","–ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ URL","–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–≤–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é"],c:[0,2,3],hint:"–í—Å–µ, —â–æ –¥–æ–¥–∞—î –±–µ–∑–ø–µ–∫—É"}]};function loadProgress(){const saved=localStorage.getItem('cyberProgress');progress=saved?JSON.parse(saved):{'–ü–∞—Ä–æ–ª—ñ':0,'–°–æ—Ü–º–µ—Ä–µ–∂—ñ':0,'–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞':0,'–§—ñ—à–∏–Ω–≥':0};updateProgressUI();updateLevels()}
function saveProgress(){localStorage.setItem('cyberProgress',JSON.stringify(progress))}
function updateProgressUI(){['–ü–∞—Ä–æ–ª—ñ','–°–æ—Ü–º–µ—Ä–µ–∂—ñ','–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞','–§—ñ—à–∏–Ω–≥'].forEach(theme=>{const perc=progress[theme]||0;const progEl=document.getElementById(`prog-${theme.toLowerCase().replace(' ', '-')}`);const fillEl=document.getElementById(`fill-${theme.toLowerCase().replace(' ', '-')}`);if(progEl)progEl.textContent=perc+'%';if(fillEl)fillEl.style.width=perc+'%'})}
function goTo(id){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));document.getElementById(id).classList.add('active');if(id==='progress')renderProgressBars()}
function startTheme(theme){currentTask={theme,index:0,correct:0,total:tasks[theme].length};selected=null;hintsLeft=3;document.getElementById('theme-title').textContent=`–¢–µ–º–∞: ${theme}`;document.getElementById('level-title').textContent=`–†—ñ–≤–µ–Ω—å ${currentTask.index + 1}`;document.getElementById('hint-count').textContent=hintsLeft;loadTask();goTo('game')}
function loadTask(){const task=tasks[currentTask.theme][currentTask.index];const input=document.getElementById('text-input');const optionsDiv=document.getElementById('options');document.getElementById('task-text').textContent=`üìù ${task.q}`;input.style.display=task.type==='input'?'block':'none';input.value='';optionsDiv.innerHTML='';if(task.type!=='input'){task.o.forEach((opt,i)=>{const div=document.createElement('div');div.className='option';div.textContent=opt;div.onclick=()=>selectOption(i,task.type);optionsDiv.appendChild(div)})}
selected=task.type==='multi'?[]:null;updateOptions()}
function selectOption(i,type){if(type==='multi'){selected.includes(i)?selected=selected.filter(x=>x!==i):selected.push(i)}else{selected=i}
updateOptions()}
function updateOptions(){document.querySelectorAll('.option').forEach((opt,i)=>{opt.classList.remove('selected');if(Array.isArray(selected)&&selected.includes(i))opt.classList.add('selected');else if(selected===i)opt.classList.add('selected')})}
function checkAnswer(){const input=document.getElementById('text-input');const task=tasks[currentTask.theme][currentTask.index];const errorMsg=document.getElementById('error-msg');errorMsg.textContent='';let isCorrect=!1;if(task.type==='input'){if(!input.value.trim()){errorMsg.textContent='–í–≤–µ–¥—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å!';return}
selected=input.value.trim();isCorrect=selected.toLowerCase()===task.answer.toLowerCase()}else{if(selected===null||(Array.isArray(selected)&&selected.length===0)){errorMsg.textContent='–í–∏–±–µ—Ä—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å!';return}
if(task.type==='multi')isCorrect=JSON.stringify(selected.sort())===JSON.stringify(task.c.sort());else isCorrect=selected===task.c}
document.getElementById('points-earned').textContent=isCorrect?'50 –±–∞–ª—ñ–≤':'0 –±–∞–ª—ñ–≤';document.getElementById('result-icon').textContent=isCorrect?'‚úÖ':'‚ùå';document.getElementById('result-text').textContent=isCorrect?'–ü—Ä–∞–≤–∏–ª—å–Ω–æ!':'–°–ø—Ä–æ–±—É–π—Ç–µ —â–µ!';if(!isCorrect){errorMsg.textContent='‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Å–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑!';setTimeout(()=>{selected=task.type==='multi'?[]:null;if(task.type==='input')input.value='';updateOptions()},1000);return}
currentTask.correct++;showResultScreen()}
function showResultScreen(){document.querySelectorAll('.option').forEach(opt=>opt.classList.remove('correct','wrong'));setTimeout(()=>{goTo('result-screen');document.getElementById('next-level-btn').onclick=nextTask},300)}
function nextTask(){currentTask.index++;if(currentTask.index>=currentTask.total){const accuracy=Math.round((currentTask.correct/currentTask.total)*100);progress[currentTask.theme]=accuracy;saveProgress();updateProgressUI();updateLevels();alert(`–¢–µ–º–∞ "${currentTask.theme}" –∑–∞–≤–µ—Ä—à–µ–Ω–∞!\n–¢–æ—á–Ω—ñ—Å—Ç—å: ${accuracy}%`);goTo('main-menu')}else{loadTask();document.getElementById('theme-title').textContent=`–¢–µ–º–∞: ${currentTask.theme}`;document.getElementById('level-title').textContent=`–†—ñ–≤–µ–Ω—å ${currentTask.index + 1}`;goTo('game')}}
function useHint(){if(hintsLeft<=0)return alert('üòî –ü—ñ–¥–∫–∞–∑–∫–∏ –∑–∞–∫—ñ–Ω—á–∏–ª–∏—Å—å!');const task=tasks[currentTask.theme][currentTask.index];hintsLeft--;document.getElementById('hint-count').textContent=hintsLeft;alert(`üí° –ü—ñ–¥–∫–∞–∑–∫–∞: ${task.hint}\n–ó–∞–ª–∏—à–∏–ª–æ—Å—å: ${hintsLeft}`)}
function renderProgressBars(){const container=document.getElementById('progress-bars');container.innerHTML='';['–ü–∞—Ä–æ–ª—ñ','–°–æ—Ü–º–µ—Ä–µ–∂—ñ','–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞','–§—ñ—à–∏–Ω–≥'].forEach(theme=>{const perc=progress[theme]||0;const div=document.createElement('div');div.className='progress-bar';div.innerHTML=`
      <div class="label">${theme} <span id="prog-${theme.toLowerCase().replace(' ','-')}">${perc}%</span></div>
      <div class="bar"><div class="fill" id="fill-${theme.toLowerCase().replace(' ','-')}" style="width:${perc}%"></div></div>
    `;container.appendChild(div)})}
function updateLevels(){const container=document.getElementById('levels-list');container.innerHTML='';Object.keys(tasks).forEach(theme=>{for(let i=0;i<levelsCount;i++){const levelDiv=document.createElement('div');levelDiv.className='level-item';let status='locked';let statusText='–ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ';if(progress[theme]===100){status=i===0?'done':'locked';statusText=i===0?'–ü—Ä–æ–π–¥–µ–Ω–æ':'–ó–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ'}
if(i===0){status='active';statusText='–ü–æ—á–∞—Ç–æ–∫'}
if(progress[theme]&&i<progress[theme]/100*levelsCount){status='done';statusText='–ü—Ä–æ–π–¥–µ–Ω–æ'}
levelDiv.innerHTML=`${theme} - –†—ñ–≤–µ–Ω—å ${i + 1}<span class="status ${status}">${statusText}</span>`;levelDiv.onclick=()=>{if(status!=='locked')startTheme(theme)};container.appendChild(levelDiv)}})}
loadProgress()